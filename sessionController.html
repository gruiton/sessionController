<html>
<head>
	<title>Session Controller Plugin JS</title>
	<script src="https://code.jquery.com/jquery-1.12.3.js"></script>
</head>
<body>
	<h1>Session Controller PLUGIN JS</h1>
	<p>TIME COUNTER: <span id="counter">0</span></p>
	<br>
	<p>TODO:</p>
	<ul>
		<li>Extend default options</li>
	</ul>
	<script>
(function() {

	/****************************
	CONSTRUCTOR
	****************************/
	SessionController = function() {
		var self = this;
		self.instances.push(this);
		self.idInterval = null;
		self.counter = 0;
		self.options = null;

		self.controller = function(){
			$('#counter').html(self.counter);
			self.counter++;
			if(self.counter > 10){
				alert(self.options.alertText);
				self.stop();
			}
		}

		var defaults = {
			gotoUrl : "login.jsp",
			alertText : "You have lost the session.",
			time : 1000
		}
		
		if(arguments[0] && typeof arguments[0] === "object"){
			self.options = extendDefaults(defaults, arguments[0]);
		} else self.options = defaults;

	}
	
	/****************************
	PUBLIC METHODS
	****************************/

	//Global array to storage all instances created.
	SessionController.prototype.instances = [];

	SessionController.prototype.init = function(){
		console.log("SessionController has been launched");
		var self = this;
		for(var x=0; x<self.instances.length; x++){
			self.instances[x].stop();
		}
		self.idInterval = setInterval(this.controller, self.options.time);

		$(window).mousemove(function (e) {
			self.counter = 0;
		});
		$(window).keypress(function (e) {
			self.counter = 0;
		});
	}

	SessionController.prototype.stop = function(){
		clearInterval(this.idInterval);
		$('#counter').append('<span>The counter has been stopped</span>');
	}

	/****************************
	PRIVATE METHODS
	****************************/
	var stopInstances = function(){

	};

	var extendDefaults = function(source, properties) {
		var property;
		for (property in properties) {
			if (properties.hasOwnProperty(property)) {
				source[property] = properties[property];
			}
		}
		return source;
	};


	//initialize and init a default SessionController
	var SCInstance = new SessionController();		
	SCInstance.init();
}());


	</script>
	
</body>
</html>